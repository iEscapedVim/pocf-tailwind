---
import { ViewTransitions } from "astro:transitions"
---
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<meta name="generator" content={Astro.generator} />
<slot />
<script is:inline src="/node_modules/flowbite/dist/flowbite.js"></script>
<style is:global>
	@tailwind base;
	@tailwind components;
	@tailwind utilities;
    h1, h2, h3, h4, h5, h6, a, strong {
        font-family: 'Lora Variable', serif;
        font-style: italic;
    }
    p {
        font-family: 'Lato', sans-serif;
        text-align: justify;
    }
    .montserrat {
        font-family: 'Montserrat Variable', sans-serif;
    }
    ul {
        list-style-type: disc !important;
        margin-right: 3px;
    }
    li::marker {
        font-size: 21px;
        color: #eec731;
    }
</style>
<script>
    import Swal from 'sweetalert2';
    const openForm = (event: Event) => {
        event.preventDefault();
        Swal.fire({
            showCloseButton: true,
            showClass: {
                popup: `
                    bg-primary
                    p-0
                    [&>.swal2-html-container]:p-0
                    [&>.swal2-close]:text-secondary
                    [&>.swal2-close]:ring-0
                    [&>.swal2-close]:outline-0
                `
            },
            title: '<h2 class="text-secondary font-bold lora italic mb-4">Join Our Community</h2>',
            html: `
            <section id="make-member-form" class="flex flex-col justify-center items-center"
                <div class="w-full p-2" style="background-color: #fff; padding: 30px 0px;">
                    <form class="w-full flex flex-col gap-4 items-start justify-center px-6" action="post" action="/api/membership" enctype="application/x-www-form-urlencoded" data-astro-reload>
                        <h3 class="text-secondary font-bold lora italic">Orgnaization's Information</h3>
                        <div class="w-full grid grid-cols-6 gap-4">
                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Organization Name <span class="text-red-600">*</span></label>
                                <input required type="text" name="Organization Name" placeholder="Write Your Organization's Name" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">Chairman/President's Name <span class="text-red-600">*</span></label>
                                <input required type="text" name="President's Name" placeholder="President's Name" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">President's Number<span class="text-red-600">*</span></label>
                                <input required type="tel" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" name="President's Number" placeholder="+92 (123) 4567 890" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">CEO/ED/CD's Name <span class="text-red-600">*</span></label>
                                <input required type="text" name="CEO's Name" placeholder="President's Name" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">CEO/ED/CD's Number<span class="text-red-600">*</span></label>
                                <input required type="tel" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" name="CEO's Number" placeholder="+92 (123) 4567 890" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div> 
                            
                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Orphan Program's Focal Person's Name <span class="text-red-600">*</span></label>
                                <input required type="text" name="Focal Name" placeholder="Focal Person" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Focal Person's Number <span class="text-red-600">*</span></label>
                                <input required type="text" name="Focal Number" placeholder="+92 (123) 4567 890"  class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic"> Office Address: <span class="text-red-600">*</span></label>
                                <input required type="text" name="Office Address" placeholder="Office 123-A, Street 12, Sector F-6/2, Islamabad, Pakistan" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">Office Number<span class="text-red-600">*</span></label>
                                <input required type="tel" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" name="Office Number" placeholder="+92 (123) 4567 890" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div> 
                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Primary Email Address <span class="text-red-600">*</span></label>
                                <input required type="email" name="Email Address" placeholder="name@example.com" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Secondary Email Address</label>
                                <input type="email" name="Email Address" placeholder="name@example.com" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>

                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">Year of Establishment <span class="text-red-600">*</span></label>
                                <input required type="number" name="Established" placeholder="1978"  class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>
                            <div class="col-span-3 text-start">
                                <label class="text-gray-800 text-sm lora italic">Number of Sponsored Orphans <span class="text-red-600">*</span></label>
                                <input required type="number" name="Total Orphans" placeholder="32901"  class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>                            

                            <div class="col-span-6 text-start">
                                <label class="text-gray-800 text-sm lora italic">Operational Districts </label>
                                <input type="text" name="Districts " placeholder="e.g. Karachi, Lahore, Islamabad" class="w-full m-2 p-0 h-9 border-0 focus:border-b border-primary ring-0 ring-primary focus:ring-0 outline-0 outline-primary focus:outline-0 border-b">
                            </div>

                            <div class="col-span-3 flex items-start">
                                <button type="submit" class="bg-primary hover:bg-secondary text-secondary hover:text-white border-0 focus:border-0 ring-0 focus:ring-0 outline-0 focus:outline-0 py-2 px-5 text-sm lora italic font-bold">Submit</button>
                            </div>
                        </div>
                    </form>
                </div>
            </section>
            `,
            showConfirmButton: false,
            showCancelButton: false,
            focusConfirm: false,
            preConfirm: () => {
                const form = document.querySelector('#make-member-form') as HTMLFormElement;
                if (!form) {
                    throw new Error('Form element not found');
                }
                const data = new FormData(form);
                return fetch(form.action, {
                    method: form.method,
                    body: data
                }).then(response => {
                    if (!response.ok) {
                        throw new Error(response.statusText)
                    }
                    return response.json()
                }).then(data => {
                    Swal.fire({
                        title: 'Thank You',
                        text: 'We have received your joining application. We will get back to you soon.',
                        icon: 'success'
                    })
                }).catch(error => {
                    Swal.showValidationMessage(
                        `Request failed: ${error}`
                    )
                })
            }
        })
    }
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.make-member-button').forEach(button => {
            button.addEventListener('click', openForm);
        });
    });
</script>
<ViewTransitions />